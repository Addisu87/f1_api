---
openapi: 3.0.1
info:
  title: F1 Laps API
  version: v1
  description: API for accessing Formula 1 lap time data and analytics
  contact:
    name: API Support
    email: support@f1laps.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
paths:
  "/api/v1/lap_times":
    get:
      summary: List all lap times
      tags:
      - Lap Times
      parameters:
      - name: driver_id
        in: query
        required: false
        description: Filter by driver ID
        schema:
          type: integer
      - name: circuit_id
        in: query
        required: false
        description: Filter by circuit ID
        schema:
          type: integer
      - name: lap_min
        in: query
        required: false
        description: Minimum lap number
        schema:
          type: integer
      - name: lap_max
        in: query
        required: false
        description: Maximum lap number
        schema:
          type: integer
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    driver_id:
                      type: integer
                    circuit_id:
                      type: integer
                    time_ms:
                      type: integer
                    lap_number:
                      type: integer
                    created_at:
                      type: string
                      format: date-time
                    updated_at:
                      type: string
                      format: date-time
                  required:
                  - id
                  - driver_id
                  - circuit_id
                  - time_ms
                  - lap_number
    post:
      summary: Create a lap time
      tags:
      - Lap Times
      parameters: []
      responses:
        '201':
          description: Created
        '422':
          description: Unprocessable
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                driver_id:
                  type: integer
                circuit_id:
                  type: integer
                time_ms:
                  type: integer
                lap_number:
                  type: integer
              required:
              - driver_id
              - circuit_id
              - time_ms
              - lap_number
  "/api/v1/circuits":
    get:
      summary: List circuits
      tags:
      - Circuits
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    name:
                      type: string
                    location:
                      type: string
                    length_km:
                      type: number
                    created_at:
                      type: string
                      format: date-time
                    updated_at:
                      type: string
                      format: date-time
                  required:
                  - id
                  - name
                  - location
    post:
      summary: Create circuit
      tags:
      - Circuits
      parameters: []
      responses:
        '201':
          description: Created
        '422':
          description: invalid request
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                location:
                  type: string
                length_km:
                  type: number
              required:
              - name
              - location
  "/api/v1/circuits/{id}":
    parameters:
    - name: id
      in: path
      required: true
      schema:
        type: integer
    get:
      summary: Show circuit
      tags:
      - Circuits
      responses:
        '200':
          description: OK
    patch:
      summary: Update circuit
      tags:
      - Circuits
      responses:
        '200':
          description: Updated
    delete:
      summary: Delete circuit
      tags:
      - Circuits
      responses:
        '204':
          description: Deleted
  "/api/v1/drivers":
    get:
      summary: List drivers
      tags:
      - Drivers
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    name:
                      type: string
                    code:
                      type: string
                    team:
                      type: string
                    country:
                      type: string
                    created_at:
                      type: string
                      format: date-time
                    updated_at:
                      type: string
                      format: date-time
                  required:
                  - id
                  - name
                  - code
    post:
      summary: Create driver
      tags:
      - Drivers
      parameters: []
      responses:
        '201':
          description: Created
        '422':
          description: invalid request
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                code:
                  type: string
                team:
                  type: string
              required:
              - name
              - code
  "/api/v1/drivers/{id}":
    parameters:
    - name: id
      in: path
      required: true
      schema:
        type: integer
    get:
      summary: Show driver
      tags:
      - Drivers
      responses:
        '200':
          description: OK
    patch:
      summary: Update driver
      tags:
      - Drivers
      responses:
        '200':
          description: Updated
    delete:
      summary: Delete driver
      tags:
      - Drivers
      responses:
        '204':
          description: Deleted
  "/api/v1/health":
    get:
      summary: Get API health status
      tags:
      - Health
      responses:
        '200':
          description: health status
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum:
                    - healthy
                  version:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
                required:
                - status
                - version
                - timestamp
  "/api/v1/drivers/{driver_id}/lap_times":
    parameters:
    - name: id
      in: path
      required: true
      schema:
        type: integer
    get:
      summary: List lap times for a driver
      tags:
      - Lap Times
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                properties:
                  id:
                    type: integer
                  driver_id:
                    type: integer
                  circuit_id:
                    type: integer
                  time_ms:
                    type: integer
                  lap_number:
                    type: integer
                  created_at:
                    type: string
                    format: date-time
                  updated_at:
                    type: string
                    format: date-time
                required:
                - id
                - driver_id
                - circuit_id
                - time_ms
                - lap_number
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    driver_id:
                      type: integer
                    circuit_id:
                      type: integer
                    time_ms:
                      type: integer
                    lap_number:
                      type: integer
                    created_at:
                      type: string
                      format: date-time
                    updated_at:
                      type: string
                      format: date-time
                  required:
                  - id
                  - driver_id
                  - circuit_id
                  - time_ms
                  - lap_number
      parameters:
      - name: driver_id
        in: path
        required: true
        schema:
          type: integer
    patch:
      summary: Update lap time
      tags:
      - Lap Times
      parameters: []
      responses:
        '200':
          description: Updated
        '422':
          description: Invalid
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                time_ms:
                  type: integer
    delete:
      summary: Delete lap time
      tags:
      - Lap Times
      responses:
        '204':
          description: Deleted
  "/api/v1/circuits/{circuit_id}/lap_times":
    get:
      summary: Get lap times for a specific circuit
      tags:
      - Lap Times
      parameters:
      - name: circuit_id
        in: path
        required: true
        schema:
          type: integer
      responses:
        '200':
          description: lap times found
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    driver_id:
                      type: integer
                    circuit_id:
                      type: integer
                    time_ms:
                      type: integer
                    lap_number:
                      type: integer
                    created_at:
                      type: string
                      format: date-time
                    updated_at:
                      type: string
                      format: date-time
                  required:
                  - id
                  - driver_id
                  - circuit_id
                  - time_ms
                  - lap_number
  "/api/v1/auth/register":
    post:
      summary: Register a new user
      tags:
      - Users
      parameters: []
      responses:
        '200':
          description: user registered
        '422':
          description: registration failed
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                user:
                  type: object
                  properties:
                    email:
                      type: string
                    password:
                      type: string
                    password_confirmation:
                      type: string
                  required:
                  - email
                  - password
                  - password_confirmation
  "/api/v1/auth/login":
    post:
      summary: Login user
      tags:
      - Users
      parameters: []
      responses:
        '200':
          description: login successful
        '401':
          description: login failed
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                user:
                  type: object
                  properties:
                    email:
                      type: string
                    password:
                      type: string
                  required:
                  - email
                  - password
  "/api/v1/auth/logout":
    delete:
      summary: Logout user
      tags:
      - Users
      responses:
        '200':
          description: logout successful
        '401':
          description: logout failed
components:
  securitySchemes:
    bearer_auth:
      type: http
      scheme: bearer
      bearerFormat: JWT
security:
- bearerAuth: []
servers:
- url: https://{defaultHost}
  variables:
    defaultHost:
      default: www.example.com
