---
openapi: 3.0.1
info:
  title: F1 Laps API
  version: v1
  description: API for accessing Formula 1 lap time data and analytics
  contact:
    name: API Support
    email: support@f1laps.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
paths:
  "/api/v1/circuits":
    get:
      summary: List circuits
      tags:
      - Circuits
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    name:
                      type: string
                    location:
                      type: string
                    length_km:
                      type:
                      - number
                      - 'null'
                    created_at:
                      type: string
                      format: date-time
                    updated_at:
                      type: string
                      format: date-time
                  required:
                  - id
                  - name
                  - location
    post:
      summary: Create circuit
      tags:
      - Circuits
      parameters: []
      responses:
        '201':
          description: Created
        '422':
          description: invalid request
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                location:
                  type: string
                length_km:
                  type: number
              required:
              - name
              - location
        description: Circuit attributes
  "/api/v1/circuits/{id}":
    parameters:
    - name: id
      in: path
      description: Circuit ID
      required: true
      schema:
        type: integer
    get:
      summary: Show circuit
      tags:
      - Circuits
      responses:
        '200':
          description: OK
    patch:
      summary: Update circuit
      tags:
      - Circuits
      parameters: []
      responses:
        '200':
          description: Updated
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                length_km:
                  type: number
        description: Circuit attributes to update
    delete:
      summary: Delete circuit
      tags:
      - Circuits
      responses:
        '204':
          description: Deleted
  "/api/v1/drivers":
    get:
      summary: List drivers
      tags:
      - Drivers
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    name:
                      type: string
                    code:
                      type: string
                    team:
                      type: string
                    country:
                      type: string
                    created_at:
                      type: string
                      format: date-time
                    updated_at:
                      type: string
                      format: date-time
                  required:
                  - id
                  - name
                  - code
    post:
      summary: Create driver
      tags:
      - Drivers
      parameters: []
      responses:
        '201':
          description: Created
        '422':
          description: invalid request
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                code:
                  type: string
                team:
                  type: string
              required:
              - name
              - code
        description: Driver attributes
  "/api/v1/drivers/{id}":
    parameters:
    - name: id
      in: path
      description: Driver ID
      required: true
      schema:
        type: integer
    get:
      summary: Show driver
      tags:
      - Drivers
      responses:
        '200':
          description: OK
    patch:
      summary: Update driver
      tags:
      - Drivers
      parameters: []
      responses:
        '200':
          description: Updated
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                team:
                  type: string
                country:
                  type: string
        description: Driver attributes to update
    delete:
      summary: Delete driver
      tags:
      - Drivers
      responses:
        '204':
          description: Deleted
  "/api/v1/health":
    get:
      summary: Get API health status
      tags:
      - Health
      security: []
      responses:
        '200':
          description: health status
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum:
                    - healthy
                  version:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
                required:
                - status
                - version
                - timestamp
  "/api/v1/lap_times":
    get:
      summary: List all lap times
      tags:
      - Lap Times
      parameters:
      - name: driver_id
        in: query
        required: false
        description: Filter by driver ID
        schema:
          type: integer
      - name: circuit_id
        in: query
        required: false
        description: Filter by circuit ID
        schema:
          type: integer
      - name: lap_min
        in: query
        required: false
        description: Minimum lap number
        schema:
          type: integer
      - name: lap_max
        in: query
        required: false
        description: Maximum lap number
        schema:
          type: integer
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    driver_id:
                      type: integer
                    circuit_id:
                      type: integer
                    time_ms:
                      type: integer
                    lap_number:
                      type: integer
                    created_at:
                      type: string
                      format: date-time
                    updated_at:
                      type: string
                      format: date-time
                  required:
                  - id
                  - driver_id
                  - circuit_id
                  - time_ms
                  - lap_number
    post:
      summary: Create a lap time
      tags:
      - Lap Times
      parameters: []
      responses:
        '201':
          description: Created
        '422':
          description: Unprocessable
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                driver_id:
                  type: integer
                circuit_id:
                  type: integer
                time_ms:
                  type: integer
                lap_number:
                  type: integer
              required:
              - driver_id
              - circuit_id
              - time_ms
              - lap_number
        description: Lap time data
  "/api/v1/lap_times/{id}":
    parameters:
    - name: id
      in: path
      description: Lap time ID
      required: true
      schema:
        type: integer
    get:
      summary: Show lap time
      tags:
      - Lap Times
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                  driver_id:
                    type: integer
                  circuit_id:
                    type: integer
                  time_ms:
                    type: integer
                  lap_number:
                    type: integer
                  created_at:
                    type: string
                    format: date-time
                  updated_at:
                    type: string
                    format: date-time
                required:
                - id
                - driver_id
                - circuit_id
                - time_ms
                - lap_number
    patch:
      summary: Update lap time
      tags:
      - Lap Times
      parameters: []
      responses:
        '200':
          description: Updated
        '422':
          description: Invalid
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                time_ms:
                  type: integer
        description: Lap time attributes to update
    delete:
      summary: Delete lap time
      tags:
      - Lap Times
      responses:
        '204':
          description: Deleted
  "/api/v1/drivers/{driver_id}/lap_times":
    parameters:
    - name: driver_id
      in: path
      description: Driver ID
      required: true
      schema:
        type: integer
    get:
      summary: List lap times for a driver
      tags:
      - Lap Times
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    driver_id:
                      type: integer
                    circuit_id:
                      type: integer
                    time_ms:
                      type: integer
                    lap_number:
                      type: integer
                    created_at:
                      type: string
                      format: date-time
                    updated_at:
                      type: string
                      format: date-time
                  required:
                  - id
                  - driver_id
                  - circuit_id
                  - time_ms
                  - lap_number
  "/api/v1/circuits/{circuit_id}/lap_times":
    parameters:
    - name: circuit_id
      in: path
      required: true
      description: Circuit ID
      schema:
        type: integer
    get:
      summary: Get lap times for a specific circuit
      tags:
      - Lap Times
      responses:
        '200':
          description: lap times found
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    driver_id:
                      type: integer
                    circuit_id:
                      type: integer
                    time_ms:
                      type: integer
                    lap_number:
                      type: integer
                    created_at:
                      type: string
                      format: date-time
                    updated_at:
                      type: string
                      format: date-time
                  required:
                  - id
                  - driver_id
                  - circuit_id
                  - time_ms
                  - lap_number
  "/api/v1/standings":
    get:
      summary: Get driver standings
      tags:
      - Standings
      description: Returns driver standings based on their fastest lap times. Drivers
        are ranked by their best lap time, with points awarded to the top 10 positions
        (25, 18, 15, 12, 10, 8, 6, 4, 2, 1).
      responses:
        '200':
          description: standings retrieved
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    position:
                      type: integer
                      description: Driver position in standings (1st, 2nd, 3rd, etc.)
                    driver:
                      type: string
                      description: Driver name
                    best_lap:
                      type: integer
                      description: Best lap time in milliseconds
                    points:
                      type: integer
                      description: Championship points (25 for 1st, 18 for 2nd, etc.)
                  required:
                  - position
                  - driver
                  - best_lap
                  - points
                example:
                - position: 1
                  driver: Lewis Hamilton
                  best_lap: 85430
                  points: 25
                - position: 2
                  driver: Max Verstappen
                  best_lap: 85892
                  points: 18
        '401':
          description: unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  "/api/v1/auth/register":
    post:
      summary: Register a new user
      tags:
      - Users
      security: []
      parameters: []
      responses:
        '200':
          description: user registered
        '422':
          description: registration failed
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                user:
                  type: object
                  properties:
                    email:
                      type: string
                    password:
                      type: string
                    password_confirmation:
                      type: string
                  required:
                  - email
                  - password
                  - password_confirmation
        description: User registration data
  "/api/v1/auth/login":
    post:
      summary: Login user
      tags:
      - Users
      security: []
      parameters: []
      responses:
        '200':
          description: login successful
        '401':
          description: login failed
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                user:
                  type: object
                  properties:
                    email:
                      type: string
                    password:
                      type: string
                  required:
                  - email
                  - password
        description: User login credentials
  "/api/v1/auth/logout":
    delete:
      summary: Logout user
      tags:
      - Users
      responses:
        '200':
          description: logout successful
        '401':
          description: logout failed
tags:
- name: Health
  description: API health check endpoint
- name: Users
  description: User authentication and registration endpoints
- name: Drivers
  description: F1 driver management endpoints
- name: Circuits
  description: F1 circuit management endpoints
- name: Lap Times
  description: Lap time tracking and fastest lap endpoints
- name: Standings
  description: Driver standings and rankings
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: 'JWT token obtained from /api/v1/auth/login endpoint. Format: Bearer
        {token}'
security:
- bearerAuth: []
servers:
- url: http://localhost:3000
  description: Development server
- url: https://{customHost}
  description: Production server
  variables:
    customHost:
      default: your-production-domain.com
      description: Your production API domain
